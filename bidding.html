<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Wishlock - Bidding Page</title>
  <link rel="icon" type="image/png" href="product-pic/logo-pic.jpg"/>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
  <div class="wrapper">
    <!-- Header -->
    <header class="page-header">
      <div class="header-container">
        <div class="page-logo">
          <img src="product-pic/logo-pic.jpg" class="logo-image" alt="Logo"/>
          <a href="index.html" class="logo-text">Wishlock</a>
        </div>
        <a href="index.html" class="back-link" style="color:white;">Back to Home</a>
      </div>
    </header>

    <!-- Nội dung sản phẩm đấu giá -->
    <main class="bidding-page" style="text-align:center; margin:30px;">
      <div id="bidding-product"></div>
    </main>

    <!-- Zoom Modal -->
    <div id="zoomModal" class="modal">
      <span class="close">&times;</span>
      <img class="modal-content" id="zoomedImage" />
    </div>

    <!-- Footer -->
    <footer class="page-footer">
      <p>&copy; 2025 Wishlock Shop | All Rights Reserved</p>
    </footer>

    <script>
      const params = new URLSearchParams(window.location.search);
      const id = parseInt(params.get("id"));
      const container = document.getElementById("bidding-product");
      let currentBid = 0;

      fetch('bidding-data.json')
        .then(res => res.json())
        .then(products => {
          const product = products.find(p => p.id === id);
          if (!product) {
            container.innerHTML = "<p>Product not found.</p>";
            return;
          }

          currentBid = 100; 

          container.innerHTML = `
            <div class="bidding-product-container">
              <div class="item-image zoom-container">
                <img src="${product.image}" alt="${product.name}" class="zoom-img">
              </div>

              <div class="bidding-info">
                <p class="timer">Auction ends in: <span class="timer" id="countdownTimer">00:05:00</span></p>
                <h1>${product.name}</h1>

                <p>Current Highest Bid: <span id="currentBid">$${currentBid}</span></p>

                <div class="bidding-box">
                  <input type="number" id="bidInput" placeholder="Enter your bid" min="1">
                  <button class="bid-button" onclick="placeBid()">Place Bid</button>
                </div>

                <p class="product-shipping"><strong>Shipping Fee</strong> ${product.shipping_fee}</p>

                <div class="product-desc">
                  <h3>Item description</h3>
                  <p>${product.desc}</p>
                </div>

                <div class="product-details">
                  <h3>Item Details</h3>
                  <table>
                    <tr><th>Category</th><td>${product.category}</td></tr>
                    <tr><th>Brand</th><td>${product.brand}</td></tr>
                    <tr><th>Item condition</th><td>${product.condition}</td></tr>
                    <tr><th>Ships from</th><td>${product.ship_from}</td></tr>
                  </table>
                </div>
              </div>
            </div>
          `;

          // Zoom logic
          const zoomable = document.querySelector('.zoom-img');
          const modal = document.getElementById("zoomModal");
          const modalImg = document.getElementById("zoomedImage");
          const closeBtn = document.querySelector(".close");

          zoomable.onclick = function () {
            modal.style.display = "block";
            modalImg.src = this.src;
          };

          closeBtn.onclick = function () {
            modal.style.display = "none";
          };

          window.onclick = function (event) {
            if (event.target === modal) {
              modal.style.display = "none";
            }
          };

          // Countdown
          let time = 5 * 60;
          const countdownEl = document.getElementById('countdownTimer');
          setInterval(() => {
            if (time > 0) {
              time--;
              const min = String(Math.floor(time / 60)).padStart(2, '0');
              const sec = String(time % 60).padStart(2, '0');
              countdownEl.textContent = `00:${min}:${sec}`;
            }
          }, 1000);
        });

      function placeBid() {
        const bid = parseInt(document.getElementById('bidInput').value);
        if (bid > currentBid) {
          currentBid = bid;
          document.getElementById('currentBid').textContent = `$${currentBid}`;
          alert("Your bid has been placed!");
        } else {
          alert("Your bid must be higher than the current bid!");
        }
      }
    </script>

  </div>
</body>
</html>
